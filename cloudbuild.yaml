steps:
    # Web
    # [Web] build the container image
    - name: "gcr.io/cloud-builders/docker"
      args: ["build", "-t", "gcr.io/qut-chatbot/react-chatbot:$COMMIT_SHA", "."]
      # [Web] push the container image
    - name: "gcr.io/cloud-builders/docker"
      args: ["push", "gcr.io/qut-chatbot/chatbot:$COMMIT_SHA"]
      # [Web] deploy the container to Cloud Run
    - name: "gcr.io/cloud-builders/gcloud"
      args:
        [
          "run",
          "deploy",
          "chatbot",
          "--image",
          "gcr.io/qut-chatbot/chatbot:$COMMIT_SHA",
          "--region",
          "australia-southeast1",
          "--platform",
          "managed",
          "--allow-unauthenticated"
        ]
options:
    logging: CLOUD_LOGGING_ONLY
